---
title: "[JavaScript] 복습 3"
date: 2025-04-02 20:23:37 +0900
categories: [프로그래머스 데브코스, 자바스크립트]
tags: [study, programmers, javascript]
---

<img width="1271" height="713" alt="데브자스" src="https://github.com/user-attachments/assets/b7613774-0f9a-4488-866c-d592764b69eb" />

## **JavaScript fetch**

### WEB API  

- 웹 브라우저가 제공해주는 API  
- 웹 브라우저를 기반으로 해서 사용해야 함  

### <span class="purplepen">fetch</span>()  

- 자바스크립트에서 **HTTP 요청을 보내는 내장 함수**  
- **API 호출**하기 위해서 사용함  
- 대표적인 **API ENDPOINT**  
  
    [JSONPlaceholder - Free Fake REST API](https://jsonplaceholder.typicode.com/)
    
- **사용 방법**
    
    ```js  
    fetch(요청 보낼 주소, 다양한 options)
    ```   
    내부적으로, **<span class="greenpen">Promise 객체</span>**(resolve,reject)를 반환 → 성공, 실패로 나뉨   
    실질적으로, **<span class="yellow2pen">Response 객체</span>**를 반환   
    
- **사용 방법** (**JSON 객체**를 반환)  
    
     **<span class="yellow2pen">Response 객체</span>.<span class="purplepen">json</span>()**을 사용하여 반환 받음  
    
    - 코드  
        
        ```js
        const API = "https://jsonplaceholder.typicode.com/users";
        fetch(API) //
          .then((response) => {
            console.log(response);
            return response.json();
          })
          .then((data) => {
            console.log(data);
          })
          .catch((error) => {
            console.error(error);
          });
        
        ```  
        
        <img width="463" height="296" alt="Image" src="https://github.com/user-attachments/assets/3e4e2d88-0f74-418d-9ecc-311346529470" />  
 
        
- **<span class="red2pen">에러 처리 방식</span>**  
    - 도메인 주소가 잘못됨 → reject됨   
        <img width="467" height="50" alt="Image" src="https://github.com/user-attachments/assets/22d7352f-c77e-450d-a1a9-365c385f34d1" />  
        
    - 도메인 주소 하위가 잘못됨 → **<span class="yellow2pen">Response 객체</span>.ok**:false   
        <img width="445" height="76" alt="Image" src="https://github.com/user-attachments/assets/e1db245a-b9eb-4742-912c-0923a49b52f3" />  
        
    - 코드 (수정된 처리방식)
        
        ```js
        const API = "https://jsonplaceholder.typicode.com/users2";
        fetch(API) //
          .then((response) => {
            if (!response.ok) {
              throw new Error("요청 주소가 올바르지 않습니다!");
            }
            return response.json();
          })
          .then((data) => {
            console.log(data);
          })
          .catch((error) => {
            console.error(error);
          });
        
        ```  
        
        <img width="483" height="54" alt="Image" src="https://github.com/user-attachments/assets/e2dee548-0802-4956-9aa1-c09a381e91c6" />  
        
- <span class="bluepen">async</span> & <span class="bluepen">await</span> 문으로 변경   
    - 코드  
        
        ```js
        const API = "https://jsonplaceholder.typicode.com/users2";
        
        async function fetchUserData() {
          try {
            const response = await fetch(API);
            if (!response.ok) {
              throw new Error("요청 주소가 올바르지 않습니다!");
            }
            const data = await response.json();
            console.log(data);
          } catch (err) {
            console.error(err);
          }
        }
        ```   
        
<br>

---

## **SPA**, Single Page Application  

### SPA 구현  

- **S**ingle **P**age **A**pplication  
- 필요한 부분만 `router`를 통해 URL만 바뀌어 렌더링함.  
- 경로 동작을 하기 위해, HTML 페이지 3개를 제작한다.  
    - `home`, `about`, `contact` HTML 페이지  
    - 각각 구분을 위한 문구만 간단히 작성   

### index.html

- 보여지는 문서를 작성함  
- 코드  
    
    ```html
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>router를 위해</title>
      </head>
      <body>
        <div id="root">
          <ul>
            <li>
              <a href="/">Home</a>
            </li>
            <li>
              <a href="/about">About</a>
            </li>
            <li>
              <a href="/contact">Contact</a>
            </li>
          </ul>
        </div>
        <main></main>
        <script src="./router.js"></script>
      </body>
    </html>
    
    ```  

### router.js

- 라우팅 테이블 정의  
- 링크 클릭 이벤트를 만들어, 해당 경로에 맞게 HTML 로딩   
- HTML 파일은 비동기로 로딩하여, main으로 보여줌  
- 추가로 `popstate`로 뒤로가기, 앞으로가기 구현  
- 코드  
    
    ```js
    const routes = {
      "/": "./spa/pages/home.html",
      "/about": "./spa/pages/about.html",
      "/contact": "./spa/pages/contact.html",
    };
    
    function router(e) {
      e.preventDefault();
      window.history.pushState({}, "", e.target.href);
      handleLocation();
    }
    
    async function handleLocation() {
      const pathname = window.location.pathname;
      const data = await (await fetch(routes[pathname])).text();
      document.querySelector("main").innerHTML = data;
      console.log(data);
    }
    
    window.addEventListener("DOMContentLoaded", () => {
      Array.from(document.querySelectorAll("a")) //
        .forEach((element) => {
          element.addEventListener("click", router);
        });
    });
    
    ```  
    
    <img width="631" height="366" alt="Image" src="https://github.com/user-attachments/assets/4c73fd38-ab88-49fd-afc8-f6457ccde8b1" />  


---